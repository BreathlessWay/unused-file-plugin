function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(t,o,l){return o=r(o),function(t,i){if(i&&("object"===e(i)||"function"==typeof i))return i;if(void 0!==i)throw new TypeError("Derived constructors may only return object or undefined");return n(t)}(t,i()?Reflect.construct(o,l||[],r(t).constructor):o.apply(t,l))}function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function i(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(i=function(){return!!e})()}function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}function l(e,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},l(e,t)}function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,a(i.key),i)}}function c(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,n||"default");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:String(n)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.WebpackUnusedFileListPlugin=exports.ViteUnusedFileListPlugin=void 0;var p=require("fs-extra"),d=require("fast-glob"),h=c((
/**!
 * 插件初始化参数
 * @param {object} [options] - 对象参数
 * @param {string} [options.dir=src] - 所查找的目录，默认 src
 * @param {boolean} [options.remove=false] - 是否删除未使用的文件，默认 false
 * @param {string[]} [options.whitelist] - 不需要被标记为无用文件的列表
 * @param {string[]} [options.whiteExt] - 不需要被标记为无用文件后缀名
 */
function e(t){var n,i,r,o,l=this;s(this,e),f(this,"getSourceFileList",(function(e){var t=d.sync("".concat(l.dir,"/**/*"),{dot:!0,cwd:e,absolute:!0});l.allFileList=new Set(t)})),f(this,"ignoreFile",(function(e){if(l.whitelist.length&&l.whitelist.includes(e))return!0;if(l.whiteExt.length&&null!=e&&e.endsWith(l.whiteExt))for(var t=0,n=l.whiteExt.length;t<n;t++){var i=l.whiteExt[t];if(null!=e&&e.endsWith(i))return!0}return!1})),f(this,"sliceFilePath",(function(e){return e.replace(/\?.*$/,"")})),f(this,"removeUnusedFile",(function(e){var t=[];l.allFileList.forEach((function(e){l.ignoreFile(e)||(t.push(e),l.remove&&p.removeSync(e))})),p.outputJsonSync("".concat(e,"/unused-plugin-file.json"),{unused:t},{spaces:"\t"})})),this.dir=null!==(n=null==t?void 0:t.dir)&&void 0!==n?n:"src",this.remove=null!==(i=null==t?void 0:t.remove)&&void 0!==i&&i,this.allFileList=new Set,this.whitelist=null!==(r=null==t?void 0:t.whitelist)&&void 0!==r?r:[],this.whiteExt=null!==(o=null==t?void 0:t.whiteExt)&&void 0!==o?o:[]}));exports.WebpackUnusedFileListPlugin=function(e){function n(){return s(this,n),t(this,n,arguments)}return o(n,h),c(n,[{key:"apply",value:function(e){var t=this;e.hooks.emit.tapAsync("UnusedFileListPlugin",(function(e,n){t.getSourceFileList(e.compiler.context),e.chunks.forEach((function(e){e.getModules().forEach((function(e){e.buildInfo&&e.buildInfo.fileDependencies&&e.buildInfo.fileDependencies.forEach((function(e){e=t.sliceFilePath(e),t.allFileList.has(e)&&t.allFileList.delete(e)}))}))})),t.removeUnusedFile(e.compiler.context),n()}))}}]),n}(),exports.ViteUnusedFileListPlugin=function(e){function i(){var e;s(this,i);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return f(n(e=t(this,i,[].concat(o))),"init",(function(){var t=process.cwd();e.getSourceFileList(t);var i=n(e);return{name:"unused-file-list-plugin",resolveId:function(e,t){var n=i.sliceFilePath(t);return i.allFileList.has(n)&&i.allFileList.delete(n),null},transform:function(e,t){var n=i.sliceFilePath(t);return i.allFileList.has(n)&&i.allFileList.delete(n),null},buildEnd:function(){i.removeUnusedFile(t)}}})),e}return o(i,h),c(i)}();